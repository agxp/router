<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CloudFlix</title>
</head>
<body>
<h1>Welcome to cloudflix</h1>
<form>
    Choose file...
    <input type="file" id="selector" multiple>
    <button type="button" onclick="upload()">Upload</button>
</form>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</body>
</html>
<script>
    function upload() {
        [$('#selector')[0].files].forEach(fileObj => {
            var file = fileObj[0]
            // Retrieve a URL from our server.
            retrieveNewURL(file)
        })
    }
    function retrieveNewURL(file) {
		var filename = file.name;
        axios.post(`/presignedURL`, {
            filename: filename
        }).then( function(url) {
            console.log(url)
            console.log(file)

            var config = {
                onUploadProgress: function(progressEvent) {
                    var percentCompleted = Math.round( (progressEvent.loaded * 100) / progressEvent.total );
                }
            };

            axios.put(url.data, file, config)
                    .then(function (res) {
                        console.log(res.data);
                    })
                    .catch(function (err) {
                        console.log(err.message);
                    });

        })
    }
    function uploadFile(file, url) {

    }
</script>
